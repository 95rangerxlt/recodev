gavinsharp.com

Bug 218223: Long tooltips should wrap instead of cropping text, based on original SeaMonkey patch by Chris Thomas <cst@yecc.com>, Firefox patch by shaver, r=me 
JS code-sharing module system. Patch by Alex Fritze <alex@croczilla.com> and Robert Sayre <sayrer@gmail.com>. r=shaver/brendan, sr=brendan 
bug 382237: make xpctools profiler work, and make it record time spend in the function itself. r=shaver 
bug 382744 - Correct backwards assertion check in XPCNativeScriptableInfo.  Patch by Manish Singh <manish@flock.com>, r=dbaron, sr=shaver 
Protect js_GetStringBytes from callers that happen during the last GC. Patch from brendan, bug 336907, r=daumling sr=shaver 
Bug 382034, support optional arguments in idl, r+sr=shaver 
Bug 382034, support optional args in idl, try again with fix for crash calling toString, r+sr=shaver 
Workaround that disables selected="true" which never worked anyway, r/sr=shaver
Fixing bug 317304. Implement weak references for JavaScript. Patch by Alex Fritze <alex@croczilla.com>. r+sr=shaver@mozilla.org 
Fix comment to say 'createInstance' when it really means that, since this is pointed to by devmo as API documentation; no bug; rs=shaver 
airbag_exception_s needs FORCE_STATIC_LIB=1, r=shaver 
b=390907, add ability for pageloader to perform self-timed tests, r=shaver 
b=390912, odd black bars with stroked rounded rects outside of view bounds, r=shaver, rs=k&r 
b=390912, odd black bars with stroked rounded rects outside of view bounds, r=shaver, rs=k&r (checking back in, linux failure seemed transient yay) 
Bug 298842 make the temp file part of nsITransfer r=mconnor sr=darin a=shaver 
bug 179656 - allow drag and drop reordering of tabs, patch originally based on miniT by dorando, r=vlad, a=shaver 
attempting to fix test bustage.  rs=shaver 
Bug 398114. JS_Assert: (cx)->requestDepth || (cx)->thread == (cx)->runtime->gcThread from nsJSSh::Init. r=mrbkap, sr=shaver 
copy WINNT5.2 config for vista, npotb, r=crowder 
Bug 297433 On Mac OS X preview.png and icon.png in Firefox's classic.jar are not available when using the jar protocol patch by rob_strong@exchangecode.com r=shaver a=shaver 
Bug 218223: Long tooltips should wrap instead of cropping text, based on original SeaMonkey patch by Chris Thomas <cst@yecc.com>, Firefox patch by shaver, r=me 
bug 179656 - allow drag and drop reordering of tabs, patch originally based on miniT by dorando, r=vlad, a=shaver 
leash up the cookiemonster (cookie eviction should be in lastaccessed order, bug 403372). r=sdwilsh, sr=shaver. also includes unnecessary code removal fix by Marco Bonardo (mak77@supereva.it), bug 403767. 
move permission manager persistent storage from hostperm.1 to permissions.sqlite, use nsIURI::GetAsciiHost() for consistent host normalization, and expand type/permission limits. bugs 400092 and 400097 (patch in 400097), sr=shaver, pending r=sdwilsh, blocking-1.9+. 
Config file for Solaris 10 from Wesley Garland (wes@page.ca), r=shaver. 
I'm dumb. Please forgive me. Yes, that includes you, shaver. 
Fix think-o causing valgrind errors during evalcx(). bug 414219, r=shaver NPOTB 
Bug 302387: rdf_FormatDate() generates incorrect timezone information; p=ian@mckellar.org, r=pike,sr=shaver,a1.9=dsicore 
Fixing bug 413774. Don't suspend/resume requests when making native calls into C++ in XPConnect, do the suspend/resume when pushing/popping JS contexts off of the context stack instead. r=shaver@mozilla.org, sr=brendan@mozilla.org 
Don't self-lock in the JSGC_BEGIN callback (413097, r=shaver). 
Move serialized cycle detector for __proto__ and __parent__ into js_GC (414452, r=igor+shaver). 
Try to fix Ts regression (414452, r=shaver). 
enable pipelining over SSL by default. b=414477, r=biesi, sr=shaver, a=mconnor 
Return of the property cache (365851, r=shaver). 
Fix bogus assertion (416404, r=shaver). 
Put js_DisablePropertyCache in the right place in the obj_eval flow graph (416406, r=shaver). 
Missing unlock in propcache setprop/setname code, plus two cleanups (416478, r=shaver, mad props to jorendorff). 
Export js_CheckForStringIndex from jsobj.c for use by assert in jsinterp.c (416460, r=shaver). 
Pass per-item offsets to ScriptBreak. Bug 416721, r=masayuki, sr=shaver, a=mconnor 
regression test. r=shaver 
Cope with GC under js_{Find,Lookup}Property in ASSERT_VALID_PROPERTY_CACHE_HIT (417033, r=shaver). 
Fixing bug 416931. Make accessing script defined global properties faster.  r+sr=shaver@mozilla.org 
Fix stupidity from patch for 414452 (417144, r=shaver, thanks to vlad for finding). 
Must set initial slot value in js_DefineNativeProperty via write barrier (417012, r=shaver). 
Bug 416675: refactor JSScope locking for reuse on non-native objects. r+a=brendan. 
Bug 322889: implement specialized storage and operations for JS arrays; r+a=brendan 
Bug 322889: implement specialized storage and operations for JS arrays; r+a=brendan. 
back out for mochitest failures in prototype 
Defend against compiler pseudo-frames (417944, r=shaver). 
Guard property cache tests with native ops or obj guards (417981, r=shaver). 
Implement optimized object-ops for dense arrays, b=322889, r+a=brendan. 
Fix js_CheckAccess to handle use in non-native objects' ops, fixing test-suite regressions from native-arrays landing. r=mrbkap, a=brendan. 
Property-cache dense array methods in JSOP_CALLPROP (418239, r=shaver). 
Bug 418616 - fix use of uninitialized data in js_CheckAccess, patch by Blake Kaplan <mrbkap@gmail.com>, r+=shaver, a+=brendan 
jorendorff's JS_DEBUG_TITLE_LOCKS patch (417818, r=shaver). 
Beware non-native objects along scope and proto chains in property cache hit testing (418540, r=shaver). 
ASSERT_VALID_PROPERTY_CACHE_HIT must be for ST spidermonkey only (417817, r=shaver). 
Bug 419018 - Fix silly crash in slowarray_enumerate, patch by mrbkap, r=shaver, a1.9=mconnor 
Shaver's huge patch for 419152 (Huge, I say; r=me). 
Fix regression from 419152 to test for 58274 (r/a=shaver). 
Optimize object initialisers via property cache; remove JSOP_SET{NAME,PROP} cache hazards (129496, r=shaver). 
Landing shaver's patch for 419743, r/a=me. 
Fix bogus assertion with compensating code (419803, r=shaver, a=beltzner). 
JavaScript Tests - regression tests for bug 419152, by Mike Shaver 
Cope with JSOP_INITPROP property cache proto-property-with-non-stub-setter hazard (419822, r=shaver, a=beltzner). 
Unbitrot JS_OPMETER (363529, r=shaver, a=beltzner/sayrer). 
Another assert that was an already-coped-with property cache hazard (420087, r=shaver, a=beltzner). 
Fix property cache fill to recompute protoIndex to handle XBL and other JS_SetPrototype users (418139, r/a=shaver). 
Bug 414389 - "M3 Windows icons" (Fix RSS icon, AMO ratings, menu-(back|forward), and livemark items) [p=reed r=gavin a1.9b4=shaver a=blocking-firefox3+] 
b=392351, implement about:memory framework core r=shaver, sr=bsmedberg 
b=392351, implement about:memory framework core, relading with forward-declaration victory; r=shaver,sr=bsdmedberg 
Bug 358599: Crash when closing tab [@ nsSHistory::EvictWindowContentViewers], r+sr=bzbarsky, a=shaver 
bug 421552 - allow users to send a crash report and quit firefox. patch by Mike Beltzner <beltzner@mozilla.com>, r=me, a=shaver 
Bug 421325: array_join_sub does not handle holes in dense arrays correctly, r/a=shaver 
Bug 404225 - improve nsCookieService::GetEnumerator() performance. r+sr+a=shaver 
Localisation fix for bug 408115, late-late-l10n. r=mano, a=shaver 
Fix from Sebastian Redl to compile under GCC 4.2 (r=me, a=shaver). 
JavaScript Tests - regression test for bug 420087, by Mike Shaver 
Bug 421774 consolidate jsd static variables into main r=shaver 
Bug 421984. Build with -fstrict-aliasing on GCC platforms. r/a=shaver 
Bug 419990 - "Firefox hides the urlbar dropmarker too late when chromehidden contains toolbar" (Correct the chrome size accounting when chromehidden contains toolbar) [p=frnchfrgg-mozbugs@altern.org (RIVAUD Julien [_FrnchFrgg_]) r=Mano a1.9=shaver] 
Bug 246699 CAPS security exceptions should throw richer exception info (not just raw string) r=shaver a=shaver 
Bug 422286: fix accounting of array length when slicing dense arrays. r=mrbkap, a=mconnor. 
bug 395581 release and null out mTransaction when its Init method failed so that we don't try to do anything with this half-initialized object, in particular call Close on it. r+sr=bz a=shaver 
Bug 421943 ? "redundant multiplexed document" should be a warning not assertion (r=sayre, sr+a=shaver) 
bug=422348 r,a1.9=shaver proper overflow error reporting 
Back out bug 246699 to fix bug 423375, per shaver 
Fix bug 423043, js shell print() should flush stdout.  r+a=shaver.  Does not affect Firefox. 
Bug 383430 - Add features to XHR for convenience of background requests.  Patch by Manish Singh <manish@flock.com>  r/sr=sicking, a1.9=shaver 
(NPOTB, r=mrbkap, a=lumpy) Remove ancient caps test cruft in preparation for incoming mochitests.  Also so that the tests listed in securetest.list will not mock me from beyond the NSCP grave. 
Test for bug 423379 (content can load chrome and/or resource), r/sr=jst. 
Don't leave an exception just hangin' out on the JSContext.  Bug 422009, r+sr=jst, a=shaver 
Fix for JSCLASS_NEW_RESOLVE-related bug in js_FillPropertyCache, found by Mike Moening <MikeM@RetekSolutions.com> (418989, r=shaver, a=beltzner). 
Bug 246699: report better errors (with stacks) for security denials. r+sr=jst, a=mconnor. 
Bug 424035. Crash [@ JS_IsArrayObject] when trying to decode a bogus JSON string. r=shaver 
b=414201, JPEG images dragged to Finder have file extension changed to .jfif; r=stan,sr=shaver,a=beltzner 
b=414201, [relanding] JPEG images dragged to Finder have file extension changed to .jfif; r=stan,sr=shaver,a=beltzner 
Bug 420973 - printObj crashes on dense arrays, r/a1.9b5=shaver 
Bug 424405 - "XDR should compensate for traps set in the script it is serializing" [p=crowder@fiverocks.com (Brian Crowder) r+a1.9b5=shaver] 
Fix bug and modularity loss introduced by patch for 424405 (424614, r/a=shaver, bug a=beltzner). 
[Bug 424693] using jsop_lineno to speedup pc->lineno mapping needed for eval. r=shaver a1.9b5=beltzner 
Bug 423273 - Fix storage API to not break old behavior.  r=shaver, sr=shaver, a=shaver 
Bug 424226 Immediate Fx crash when starting venkman [@ nsPluginHostImpl::TrySetUpPluginInstance] r=jst sr=jsr a=shaver 
JavaScript Tests - regression test for bug 422286, by Mike Shaver 
Bugs 423443/419661: crash in MarkSharpObjects due to stack overflow, when over-deep engine-internal recursion is triggered in JS components. r=brendan, a-b5=beltzner 
Bug 235853: don't freeze the UI when resolving DNS for PAC, by using deferred resolution if we would otherwise block on DNS. r+madskills=biesi, a-b5=mconnor 
bug 420187, hang in nsNSSHttpRequestSession::internal_send_receive_attempt r=rrelyea, pending more comments blocking1.9=shaver approval1.9b5=beltzner 
Bug 420187. Backing out all 3 patches from today, because of regressions. a=shaver 
Bug 424066 - "CheckSameOriginURI reports spurious error during routine internal comparison" (make NS_ScriptErrorReporter not whine about inequal origin URLs when constructing exceptions) [p=shaver@mozilla.org (Mike Shaver) sr=bzbarsky a1.9b5=beltzner] 
Bug 425747: silencing warnings in jsdtrace.c, r/a=shaver 
Bug 235853: Defer proxy resolution for HTTP and HTTPS PAC to avoid blocking main thread during DNS resolution, patch by shaver@mozilla.org, r+sr=biesi, a=beltzner 
Bug 419615 - "use JSVERSION_LATEST in xpcshell" (use a context callback to set error-reporter and jsversion default) [p=crowder@fiverocks.com (Brian Crowder) r+a1.9=shaver] 
Bug 425139: XPCSafeJSObjectWrapper provides incorrect type information, patch by shaver@mozilla.org, r=mrbkap, a=beltzner 
Bug 352604: Assertion failure !OBJ_GET_PROTO(cx, ctor) after deleting Function, r=brendan, a1.9=shaver 
Bug 429336 - Upgrade to sqlite 3.5.8.  r=shaver, a=beltzner 
Bug 235853: Defer proxy resolution for HTTP and HTTPS PAC to avoid blocking main thread during DNS resolution, and fix HTTP channel code to properly forward cache-related properties to new proxied channels, patch by shaver@mozilla.org, r+sr=biesi, a=beltzner 
Bug 416933 - Invalid range error for some case-insensitive regular expressions, r/a=shaver 
Bug 413909: nsCertOverrideService IDN handling is broken, and its port handling is also quite cumbersome, patch by Honza Bambas <honzab@allpeers.com>, r=kaie, a=shaver 
Bug 424402: Test a combination of shared and unshared database connections, patch by Ondrej Brablc <ondrej@allpeers.com>, r=shaver 
Bug 429110, Random crashing ( [@ PR_AtomicIncrement] ?) ( [@ nsIOService::NewURI] ?) r=rrelyea, a1.9=shaver 
Make nsITimerCallback a [function], to allow JS to pass a function object instead of this interface Bug 430305 r/sr/a=shaver 
Bug 428021: Can't define both a getter and a setter for a property of the global object, patch by Brian Crowder <crowder@fiverocks.com>, r=shaver, r=mrbkap, a=shaver 
Bug 406954, Unable to add exception for server certificates with empty subject names r=rrelyea, a1.9=shaver 
Bug 422137 - assertion botch or bogus OOM when decompiling script with debugger trap on JOF_CALL bytecode, r=igor, a1.9=shaver 
Bug 430717: fix lookup of incorrect ID when delegating to prototype for hole in dense array. r=mrbkap, a=mconnor. 
JavaScript Tests - regression test for bug 422137, by Mike Shaver 
JavaScript Tests - regression test for bug 430717, by Mike Shaver 
Bug 429252 - trap changes decompilation of "{ let X }", r/a=shaver 
Clear GetSrcNote cache in js_UntrapScriptCode (431428, r/a=shaver). 
[Bug 431489] r=brendan a1.9=shaver 
Bug 431346 - File -> Import -> Browsing History crash Firefox [@ nsCOMPtr.h:931]. r=sdwilsh, b-ff3=beltzner, a1.9=shaver. Fixes Bug 431597 - Firefox crash after deleting History Item via Places Library [@ nsNavHistoryResult.h:429] 
Bug 431465 - Crash [@DecompileExpression] with trap, r/a=shaver 
[Bug 427798] faster js_PutBlockObject(), r=brendan a1.9=shaver 
Bug 431465 -- (relanding) Crash [@ DecompileExpression] with trap, r=brendan, shaver, igor; a=mtschrep 
Fix 433279, r=mrbkap+shaver, a=schrep. 
Bug 421482 - Firefox 3 uses fsync excessively.  r=shaver, a=schrep 
bug 417732: fix delay and disk activity when full/text zooming by turning PRAGMA SYNCHRONOUS off for the content prefs database; r=mconnor, a=shaver 
Fixing bug 434673. Fix GC safety issue when calling through XPCWrapper into an IDL defined function. r+sr=brendan@mozilla.org, a=shaver@mozilla.org 
Bug 398332. Merge reflow statuses from out-of-flow frames more carefully so that we don't lose information about the primary reflow. r=fantasai,r+sr=dbaron,a=shaver 
[Bug 435546] proper stacking of JS_(PUSH|POP)_TEMP_ROOT. r=brendan aRC2=shaver 
Propagate the linking page's principal when a file:// URI links to a file:// URI that it's allowed to read.  Bug 435362, r=dveditz, sr=sicking, a=shaver 
Bug 435959, Firefox 3 RC 2 should take NSS 3.12 RC 4 This is to pick up fixes for OCSP crash bugs 433386 and 433594 approved by shaver for Firefox 3 RC 2 
Bug 422055: use jemalloc on Solaris, r=ted, a=shaver 
Bug 433328: properly handle null inner window, patch by Blake Kaplan <mrbkap@gmail.com>, r+sr=jst, a=shaver 
Bug 434749: [RTL] Drag&Drop bookmarks in Firefox 3 not usable, patch by Asaf Romano <mano@mozilla.com>, r=mconnor, a=shaver 
Backout of bug 357670 due to bug 434914. a=shaver 
Bug 435853 Running xpcshell tests involving Mac components leaks memory due to not having an NSAutoreleasePool. r=shaver,sr=brendan 
r=shaver 
b=429387, add --with-arm-kuser; use it in JS, and pass it down to NSPR's configure; r=shaver,r=ted 
Bug 429930 - NS_ABORT_IF_FALSE lies and doesn't abort if the given condition is false, making it exactly equivalent to NS_ASSERTION.  Make it abort so we can use it when we really want a fatal assertion, if only the NS_ASSERTION macro implemented it.  r+sr=shaver 
Fix 260106, r=shaver. 
sr=shaver 
Bug 432525: optimize string.replace for flat strings; r=brendan 
Bug 424399: Remove unused directory  "js/src/fdlibm". r+a=shaver 
Make CallTree compile with a C++ compiler. bug 441533, r=shaver 
Fix 433672, r=igor, a=shaver. 
Bug 435226 - dense arrays yield bogus __count__ values, r=shaver 
Bug 434837 - Accessors in prototype chain of arrays don't assign 'this' correctly, r=shaver, r=brendan 
Bug 435345 - Cannot accurately watch the 'length' property of arrays, r=shaver 
Bug 438415 - Assertion failure: *vp != JSVAL_HOLE, r=shaver, r=brendan 
Don't use 'i' if the id was not an index. bug 443843, r=shaver 
remove user-debug code that no longer compiles. r=shaver (no bug) 
remove user-debug code that no longer compiles. r=shaver (no bug) 
sr=shaver 
sr=shaver 
dis and dissrc throw not-exceptions when passed invalid arguments. bug 422592, r=shaver 
Test that the object has the right class, even when called from native code. bug 444233, r=shaver 
Property-cache JSOP_NAMEINC etc. direct slot case (445893, r=shaver). 
Property-cache JSOP_NAMEINC etc. direct slot case (445893, r=shaver). 
Fix property cache fill to use the best shape (445899, r=shaver). 
Always select gvar ops for declared global vars, instead of only if loopy/enough-used (445901, r=shaver). 
Propagate compilation errors to our caller to make syntax errors easier to debug. bug 408412, r=shaver sr=brendan 
Propagate compilation errors to our caller to make syntax errors easier to debug. bug 408412, r=shaver sr=brendan 
Disable gczeal on worker threads tests, r=sicking, a=shaver. 
rename ENABLE_TRACER to TRACING_ENABLED and explicitly parameterize on cx 
merge 
Add guards for XML objects, and some tracer bits to accommodate them. 
abort tracing if we see an XML object in an equality op 
regresses js1_5/String/regress-322772.) 
avoid trace-troubling temporaries via cast gymnastics 
Implement icmp_ne (in terms of LIR_ugt(i, 0)!) and make JSOP_NE traceable. 
fix typo in DoIncDec leading to script termination 
cases). 
work in TRY_BRANCH_AFTER_COND. 
guard on inlined branch in TRY_BRANCH_AFTER_COND 
synthesize LIR_ne using LIR_eq instead of LIR_ugt, per edwsmith's wisdom 
label arg/var/stack/sp/state for easier trace-reading 
fix frame offset calculation for args, I think also non-entry frames 
Assembler requires that guard be on a cmp, so force that 
beginning of trace-capability regression minisuite; will crash you today! 
use floating point LIR for dealing with doubles 
no need for rooting of integer values 
Added dmod builtin and flag broken builtins for removal (shaver). 
[mq]: simple-ops 
merge 
update to isInt 
insLoad before they'll work. 
shift ops 
Code generators to access object slots and native code callouts (builtins) for boxing doubles and ints. Ints have to be boxed through a native code helper on read and write (BoxInt32 and UnboxInt32), because we sometimes have to cast internally to double to store 32-bit values. We don't want a separate trace in this case, so we have to do this inline in a helper. Also a couple of modifications to shaver's code. Always make sure to check types (JSOP_NEG). 
use FASTCALL for builtins 
Allow hole-filling JSOP_SETELEM to remain on trace. 
Handle boolean lval in SETELEM; now runs access-nsieve unmodified. 
let JSOP_GETELEM handle boolean values too 
Implement JSOP_IFEQ, JSOP_IFNE, JSOP_DUP, JSOP_DUP2. 
Implement JSOP_DOUBLE. 
move JSOP_DOUBLE impl to, er, JSOP_DOUBLE (wtf?) 
some remaining low-hanging ops 
actually record at HOTLOOP1 (fencepost) 
TestNanojit. 
begin on JSOP_NAME, refactor stobj_get_slot to chain better 
Trace JSOP_NAME, and refactor out jsval unboxing. 
fix builtin_UnboxInt32 signature and name shape_ins for debugging 
Trace GETGVAR and INCGVAR, though not yet correctly. 
remove bogus NOT_REACHED 
we only speak double around here now 
remove outdated guard (now inferred via filter as needed) 
We urgently need shaver's magic native stack/typeframe iterator. Fixed exit map builder to skip argv/vars for global scope. 
more detailed type-instability diagnostics 
reduce loop count in trace-test for faster interp runs 
fix type checking of gvars 
Add disfile() helper to debug shell, to make it easier to see disassembly of top-level scripts. 
root converted argv[0] 
Implement JSOP_SETNAME for globals. 
protect printf with DEBUG 
rval tracking and JSOP_POPV 
merge 
Update with some additional test coverage (crashes in setgvar test) 
More tests, working on crashes. 
some build fixes to help in-browser and other-arch build 
revert ancient shuffling of js_CompareAndSwap decl to fix THREADSAFE build 
fix compilation, but possibly not logic, of shared-object defense 
fix include ordering for THREADSAFE build 
rename builtins.tbl to our usual form 
rename builtins.tbl *back*, because nanojit expects that name, and whatever 
on x86. 
build nanojit 
use stdint.h instead of typedefs to help Linux find intptr_t 
can't have zero-sized arrays in ISO C++, says gcc 
use typedefs instead of stdint.h, because someone forgot to tell MSVC it was 2008 
try to find malloc on Linux; this buildbot thing rules the school 
I'm going to just keep bludgeoning these typedefs until they stick 
MSVC knows about intptr_t, and doesn't like our remix 
update trace-test.js, now crashes calling lsh() the second time 
merge 
Unlike software developers, g++ doesn't like variable-sized arrays.  Have some alloca! 
int32_t, now available on Windows 
FASTCALL for Windows 
nanojit. 
interp needs tracer.h 
use VirtualAlloc for Windows, since it lacks valloc 
the rest of the stdint defs, no idea why I didn't do them before 
fix opcode math with the mighty hammer of casting 
shaver's favorite operating system of choice doesn't like templates, so de-template tracker since we use it with LInsp only anyway. 
try to make alloca work for Windows 
support non-JS_TRACER builds 
some better OS_CFLAGS for Linux 
disable tracer for platforms not supported by nanojit 
my turn to merge; had to happen eventually 
try to get alloca on Windows; remind me to strip these flailing commits before we merge 
use a type that windows knows about for offset computation 
don't include jstracer.h (and thus nanojit, etc.) if not building with JS_TRACER 
via javascript.options.content_jit. 
only build JIT builtins if ENABLE_JIT, and lose antique *inlines.h 
here, have a Thumb back-end 
here, have a _working_ Thumb back-end 
some ARM stuff 
Brendan fixed global variable access in non-top level code so re-enable that in trace-test.js. We pass all of shaver's trace torture tests. 
turn on all the shift tests, and find a bug with it! 
set some more config bits for Windows, mostly blindly 
begone, cat nspr/Version error noise 
Windows cares a lot more about where FASTCALL is; such a sensitive platform 
add reduced fannkuch version 
Incomplete stab at CALLPROP, added ABORT_TRACE for better diagnostics, make math_sin non-static in preparation for specializing call. 
merge 
Specialized tracing of Math.sin, as a proof of concept.  Doesn't quite work due to regalloc mismatch, but close! 
I will remember that stacked values are not boxed. 
add Math.cos and Math.pow to the specialized-call party, and add tests 
add JSOP_NEG and tests 
5 hours of debugging, and 9 keystrokes to fix it. That was one expensive bug. shaver's reduced fannkuch example works now. I think independently of this one we don't check properly for index underflow in dense arrays. Shaver is going to have to take a look at that (this fix makes fannkuch indexes not become negative, but doesn't explain why we crash so hard if they do become negative). 
Guard against subzero array indices 
initialize traceMonitor in threadsafe builds 
fix the secondary map-native guard 
expand int-equality tests 
merge 
make JSOP_CALL builtin specialization data-driven 
merge, and fix locking and logic for FORALL_SLOTS 
Clean up shaver's cleanup. 
fix our aliasing idiocy by extending jsdpun, add Math.sqrt, add strict-aliasing to our Makefile.ref flags 
more ABORT_TRACE instrumentation (some should be asserts?) 
GETVARPROP, GETARGPROP, GETXPROP 
initialize dslots_ins 
rename getpropfromval, it burns mine eyes 
Extract COMPUTE_THIS to jsinterp.h as JS_COMPUTE_THIS for reuse in tracer. 
implement JSOP_MOD 
fix scalpel left in nativeFrameSlots from aborted thisp addition to frame 
CALLARG, CALLVAR 
fix GETXPROP; thanks to brendan for playing chewbacca 
copy capacity when becoming another list 
4.2, dammit 
JSOP_LENGTH 
summarize test results 
merge, woo 
Add setprop and tests for setprop and cleanup labling code for debug mode (m=gal). 
remove pointless untracedCall test 
Show line number on abort. 
can't easily find real names for globals, so just number them 
When PROPERTY_CACHE_TEST misses, fall back to doing our own lookup via js_GetPropertyHelper. 
lookup/find, but do not fill prop cache from recorder 
Better diagnostic info for trace abort. 
Handle more operand types in ifop(). 
Also make Process do COMPILE_N_GO. 
Reset atoms base register on function entry and exit. 
discard trace on global shape mismatch 
improve tracing/recording diagnostics 
move summarization to the end, so I can see it through the debug spew 
don't pretend we can trace INCELEM and friends (fixes trace-test.js, ahem) 
force Math to be interned, and defend against non-interned globals until upvar saves us all 
simpler loop exit check (backwards is a loop exit, forwards is not) 
add simple timing harness 
merge time is fun time 
fix no-tracer build 
Avoid tracking object properties, make incElem work. 
beginning of entryFrame removal 
make time.sh more useful 
use nargs rather than argc, since bytecode only refers to [o-nargs) args 
merge (mostly, doesn't build) 
merge (now compiling, untested) 
merge (still not working, probably box/unbox dumbness) 
merge from andreas 
tighten up some bounds, still not quite right 
When addressing locations above the stack water level, use ->sp as base. Shaver accidently changed this to ->spbase when merging Igor's patch, so we were writing past the water mark and the stores were killed. 
fix return-value handling for new stack layout 
remove rval tracking, since it's no longer necessary 
do setelem in a builtin, so we don't abort trace every 8 times when growing 
not-yet-working beginnings of frame reconstruction 
Trace JSOP_LENGTH over flat strings.  (Need some cmovery for dep strings.) 
* Add strings test. 
signs, signs, everywhere signs 
JSOP_ADD over strings 
Handle failure signals of < 0 or NULL from traceable natives. 
trace Math.random 
Implement JSOP_EQ and JSOP_NE over strings, plus JSOP_STRING. 
Better diagnostic for non-global scope chain head. 
Backed out changeset d24e6005ee4c (causing major array-fail). 
merge backout of d24e6005ee4c to fix the world 
(Wants a specialized StringToInt32 and a filter to put it in place.) 
give strtointeger a way to avoid octal, to streamline ValueToNumber a bit 
add specialized StringToInt32 and filter for it 
Refactor trace-test.js to permit running a single test via `js trace-test.js testName`. 
Refactor js_GetUnitString to permit passing in a bare jschar, and use in js_str_fromCharCode. 
use optimized path for fromCharCode 
add test for non-empty stack on trace entry (fails currently, but no longer crashes) 
add tests for missing and excess arity for trace-entry function context 
improve naming of anonymous functions and excess args 
restore preference for getarg+length over getargprop 
excluded. 
Builtin for String.prototype.concat (single int-arg version) 
JSOP_TYPEOF and JSOP_TYPEOFEXPR 
JSOP_ANONFUNOBJ 
extend js_NewObjectWithGivenProto to permit specifying additional new-thing flags (such as GCX_DONT_BLOCK) 
implement JSOP_ADD(str, num) 
JSOP_EQ/NE for objects 
Restore lost shaver rev 0e50c89c476b -- how did that get lost? 
reland 3ea1e1317707 after the mismerge 
reland eb01b1d55d9b after the mismerge 
mistaken relanding, didn't track merges well enough 
cmp over number and (string or bool or undefined) 
NAMEINC, INCNAME, NAMEDEC, DECNAME 
guard all of jstracer.h against non-tracer builds 
fix build for !JS_TRACER, both threaded and switch interps 
add way to explicitly disable tracer for easier testing 
fix !JS_TRACER build 
merge from mozilla-central 
improve JIT-control pref naming, add one for chrome JIT, add defaults to all.js 
default to non-verbose for DEBUG, set TRACEMONKEY=verbose in env to go verbose 
re-merge from mozilla-central for post-freeze backouts 
disable vprof building so that we can build on XP 
fix js_IsLoopExit to better handle for-in exits, r=mrbkap 
say what we're returning from from EnterFrame 
trace |new Array|, via the magic of copy and paste 
disable tracing with active call object pending perf fix 
Bug 451580, fix string split assertions and return values. Tests fail with JIT on for other reasons, it seems. r=shaver 
land initial tracemonkey development, pref'd off 
landing more fixes from tracemonkey repo 
update for bent's gczealectomy 
Remove over-eager gvar optimization for JSOP_DEFFUN (451678, r=shaver). 
Bug 190177 – ASSERTION: received wrong amount: 'received == writeCount', file .../xpcom/tests/TestPipes.cpp, line 273. r=shaver, sr=bsmedberg 
Bug 451906 - Regression: Array index has different results (r=shaver). 
bug 436495 - build DumpJSStack in release builds. r=shaver 
Correct (but sadly a bit slower) property cache guarding (452140, r=shaver). 
[OS/2] Bug 451686: fix build break and fastcall warnings in js/src, r=shaver 
bug 452586 - fastcall attribute should only be used on i386. r=shaver 
Remove over-eager gvar optimization for JSOP_DEFFUN (451678, r=shaver). 
Correct (but sadly a bit slower) property cache guarding (452140, r=shaver). 
Revert accidental hunk from the merge changeset cf844bddfe57 that's causing unittest orange. r=shaver 
bug 453476: Some files didn't get compiled with -fno-exceptions. r=shaver 
Bug 451525 - Expand library names in Makefile, r=bsmedberg, sr=shaver 
Bug 453918 - TM: eliminate silly map_is_native guards on globalObj (r=shaver). 
Compile jsregexp.cpp with -O9 and -fomit-frame-pointer (456201, r=shaver). 
For GETELEM/SETELEM we must check that its a native object first before trying to compare the objects shape to the shape of the global object to ensure its not aliasing the global object (457979, r=shaver). 
Bug 408838 - DOM binding for native JSON. r+sr=shaver 
Bug 408838. Native JSON. r/sr=shaver 
Bug 408838. Native JSON. r/sr=shaver 
Bug 235853: Defer proxy resolution for HTTP and HTTPS PAC to avoid blocking main thread during DNS resolution, original patch by shaver@mozilla.org, r+sr=biesi 
bug 466378, rdf:nodeID not working when node appears as object before as subject in RDF/XML source, patch=mininet@wanadoo.fr, r=me, sr=shaver, a1.9.1=beltzner 
Make sure vpnum is not used incorrectly in the future (follow-up for 469044, r=shaver). 
Bug 467499 - Pass the proper size argument to ResizeSlots. r=shaver/crowder 
LirNameMap gets large over time and searching it with binary search is slow (475127, r=shaver). 
Backed out changeset 7246c4dcf997 (bug 469625) due to trace-test.js failures. 
Add debug hook to the threaded interpreter to trace instruction stream (476128, r=shaver). 
b=474517; add option for trace-test to skip slow tests; r=shaver 
Add skip() to LirFilter so we can pass skip-requests through instead of going to the LirBufWriter directly (477089, r=shaver). 
Bug 459161 -  Process first argument to JSON stringify and parse methods as specified by ES3.1. r=shaver 
Bug 479566 - Rename array "dense length" to capacity. r=shaver. 
Bug 465371 -  Native JSON stringification aborts on functions and xml but returns JS_TRUE. r=shaver 
Removing unused variable.  r=shaver, sr=make-gcc-happy 
bug 486106 - restoring JS*Lookup API compatibility with fast arrays. r=shaver 
bug 485511, Firefox crashes in nsExtensibleStringBundle::FormatStringFromName, p=rcampbell, r=smontagu, sr=shaver 
Fix "unused variable tm" warning I introduced a few days ago. No bug#, r=shaver. 
Bug 486326 - Specialize array methods which modify large numbers of array elements to work efficiently on dense arrays, avoiding highly generalized get/set/delete methods and the floating-point-to-integer conversions needed solely to handle large array indexes but which are rarely necessary in practice.  r=shaver 
Backout bug 490002 (Keyboard modifiers should alter the behaviour of clicking bookmarks in the native menu) because it caused blocking regression bug 494884 (Cmd-R causes new tab opening on sites with embedded flash). a=beltzner/shaver/blocking1.9.1 
Port more reliable branch test from bug 304198 to trunk to fix intermittent oranges, a=beltzner/shaver 
Bug 494371.  Only GetItemType once per itemAdded notification, instead of once per per observer per notification. r=dietrich, a=shaver. 
Bug 495021 - CAPS unconditionally builds tests, r=shaver 
Relax the testTableSwitch2 test for non-x86 platforms which don't use ::tableswitch() in jstracer.cpp. (510193, r=jorendorff) (with minor orangeness fix by jorendorff, r=shaver) 
Bug 509103 - Drop support for assigning to parameterized properties. r=shaver. 
bug 465980 - JavaScript Tests by Mike Shaver, Jeff Walden. 
Use thread-local RNG for Math.random() (511328, r=shaver,waldo). 
Atomize unit strings at birth (511567, r=shaver). 
Bug 488270 - "New APIs for precise time measurement of net requests" [r=mayhemer sr=shaver] 
r+sr=shaver 
Don't allocate in Queue constructor by default (513497, r=shaver). 
Bug 523817.  Make optional out params actually work and allow [retval] after [optional].  r=shaver 
Bump XDR version number to try to stop crashing on m-c (bug 525481). Follow-up to bug 516827. r=shaver. 
b=524904, add support for generic Windows DLL blocklist; r=shaver 
b=524904, add support for generic Windows DLL blocklist; r=shaver 
b=527122; fix for dll blocklist sporadic tinderbox crashes; r=shaver 
Bug 533079 Actually land patch addressing review comments from bug 507970 a=shaver r=biesi 
Bug 537967 - Moving FILE_ILLEGAL_CHARACTERS from nsCRT.h to nsCRTGlue.h for frozen linkages, r=bsmedberg,sr=shaver 
Bug 550602, pymake broken by recent libffi changes. Don't use 'old style suffix rules. r=shaver 
Bug 551529 - Remove __count__.  r=shaver 
Bug 547914 - Replace /LICENSE with a mention of where the canonical license info lives, and stop shipping it with binaries, r=gerv,shaver 
Bug 557406 - Intermittent xpcshell failure in test_bookmarks.js | false == true (via shaver, test landing to see orange effect) 
Bug 559438 - Decompiler bug with JSOP_CONCATN. r=shaver. 
Bug 558971 - Parser arena allocation overhead is too high. r=sayrer/shaver 
Bug 560095 - Use mozilla::services::GetObserverService(). r=biesi,dveditz,gavin,josh,jst,mrbkap,roc,sdwilsh,shaver,sicking,smontagu,surkov 
Bug 561672 - JS_Assert should fflush(stderr). r=shaver 
Bug 564950 - Make more use of mozilla::services, r=surkov, jst, neil, smontagu, roc, joshmoz, gavin, shaver 
Bug 555562 - remove xpctools as no maintainer in 3 years. r=shaver 
Properly mark undefined call and construct hooks of function proxies (bug 566781, r=shaver). 
Bug 570657 - Make the order of releasing objects and removing them in nsCOMArray's consistent; r=shaver 
Bug 513008 - Eliminate synchronous reads from cache. r=jduell.mcbugs@gmail.com, cbiesinger@gmail.com, sr=shaver@mozilla.org 
Bug 574905 - Increase hang detector timeout. r,sr=shaver 
b=560818; use jemalloc chunk allocation in GC, also add GC chunk memory report; r=shaver 
b=524308; add some names to credits; r/a=shaver 
Bug 577426 - Disable JavaXPCOM by default in all configurations, because there is no active maintainer, sr=shaver 
Bug 513008 - Eliminate synchronous reads from cache. r=jduell.mcbugs@gmail.com, cbiesinger@gmail.com, sr=shaver@mozilla.org 
a=shaver (via irc) 
Bug 513008 - Eliminate synchronous reads from cache, r=jduell,sdwilsh, sr=shaver, a=betaN+ 
Bug 513681 - part 17 - remove imgIDecoder.r=joe,sr=shaver,a=blocker 
Bug 513681 - part 17 - remove imgIDecoder.r=joe,sr=shaver,a=blocker 
Bug 513008 - Eliminate synchronous reads from cache. r=jduell,sdwilsh sr=shaver a2.0=blocking 
sr=shaver
b=590672; treat ArrayBuffer() and SomeArrayType() as (0); r=shaver 
Bug 581606 - Avoid sqlite fragmentation via SQLITE_FCNTL_CHUNK_SIZE r=asuth sr=shaver a=b6 
b=593396; implement BYTES_PER_ELEMENT on typed arrays; r=shaver 
Bug 570625, part 1: Only use back/front buffers for BasicThebesLayer and update back->front in the compositor process. r=roc sr=shaver 
Bug 570625, part 2: Add a SurfaceDescriptorX11 datatype that abstracts what's needed to share an Xlib surface to another process. r=karl sr=shaver 
Bug 570625, part 3: Add a SurfaceDescriptor IPDL union over all surfaces share-able to another process. r=roc sr=shaver 
Bug 570625, part 4: Put support in place for allocating platform-specific backing buffers for IPC layers, and synchronizing properly during transactions (i.e. XSync() on X11). The platform-specific interfaces just default to Shmem in this patch. r=karl sr=shaver 
Bug 570625, part 9: When updating thebes layers, swap out back/front buffers and invalidate the newly-painted region on the old front buffer. r=roc sr=shaver 
b=596720; enable WebGL by default; r=shaver, a=b7 
Bug 596907 - Fix glScissor calls in ContainerLayerOGL - r+a=shaver 
b=599698; remove UpdateSurfaceClip speedtrap in canvas drawImage; r+a=shaver 
Bug 600235 - Remove wifi scanning code on windows for versions less than XP SP3. r=shaver a=shaver 
bug 591836: split JS out of libxul to work around VS2005 PGO compiler crash. r=khuey a=sayrer 
b=599698; remove UpdateSurfaceClip speedtrap in canvas drawImage; r+a=shaver 
Bug 603558: add -m option to turn on method jit for xpcshell, r=dvander, a=shaver 
Bug 609248 - Move SameType outside js::Value as a workaround to gcc PR/38850. r=lw,a=shaver 
Bug 610642: s/NULL/0/ to fix build warning "NULL used in arithmetic". r=dmandelin a=shaver 
Bug 610370.  Make sure to hash shapes in dictionary lists too, if they need it.  r=brendan, a=shaver 
Bug 610642: s/NULL/0/ to fix build warning "NULL used in arithmetic". r=dmandelin a=shaver 
a=shaver, r=pending. (Landing as SeaMonkey bustage-fix) 
workaround for bugs 614677 and 613977: Disable accelerated SYN retry for FF 4.0 Beta 8. r=jduell, a=shaver 
r=shaver a=blocking 
Bug 623281: about:memory reporting for method JIT space usage, r=dvander 
missed a file, sigh 
Bug 623915: about:memory reporter for string char data, r=lw 
Back out d1a5599b49fa from bug 615546 for turning bug 592402 from something that hadn't happened for three months to a top-10 test failure, a=shaver 
Bug 624205: fix warning due to mismatched export declarations on MarkContext. 
Add API to enable/disable per-compartment GCs (bug 624229, r=shaver). 
Add JS_NewDateObject, JS_NewDateObjectMsec, JS_ObjectIsDate to the JSAPI. r=jorendorff, a=shaver. 
Add JS_NewDateObject, JS_NewDateObjectMsec, JS_ObjectIsDate to the JSAPI. Bug 625870, r=jorendorff, a=shaver. 
Bug 622144 - Code must #include <string.h> to use memset.  r=dmandelin, a=shaver 
Cache result of Function.prototype.toString (bug 629590, r/a=shaver). 
Disable jetpack service (bug 629197, r=shaver). 
Disable jetpack service and unit tests (bug 629197, r=shaver, a=blocker). 
sr=shaver
Bug 623129 - x86_64 NS_InvokeByIndex_P asm decl to reserve registers is not guaranteed to work as advertised; r=glandium a=shaver 
Disable jetpack service and unit tests (bug 629197, r=shaver). 
Bug 632490: Use a content-type hint in mozJSSubScriptLoader::LoadSubScript. r=shaver a=blocking-fennec 
Bug 633666 - Ignore return code from GetHost in PathifyURI, r=bsmedberg a=shaver 
Bug 634542 - Temporary diagnosis patch (r=dmandelin,a=shaver) 
Bug 634819 - Use the nsIWindowsRegKey APIs instead of direct Win32 API calls; r=josh,jimm a=shaver 
Luke Wagner – Bug 634542 - Temporary diagnostic patch 2 (r=dvander,a=shaver) 
Bug 635404 - Let a few more attributes inherit to the html input field in xpfe's autocomplete.xml. r=Neil, a=shaver over IRC (NPOTB). 
backout of 6bad6cd2dded due to failure of test it added (a=backout-orange) 
Backed out changeset 4d86e63ff60d, diagnostic patch; back out 3da12edf735e, followup fix; back out bug 631135 completely, unexplained intermittent orange. r=waldo, a=orange 
Fix spurious "attempt to run compile-and-go script on a cleared scope" errors (635548, r/a=shaver). 
Back out on orange (635548, r/a=shaver). 
Bug 635085 - Reconstruct any active formatting elements after auto closing a <nobr> in a nested <nobr> situation, per HTML spec.  r=hsivonen approval2.0=shaver 
Bug 622585 - Add clipped transform reftest. r=roc a=shaver 
r=dholbert a=shaver 
Fix spurious "attempt to run compile-and-go script on a cleared scope" errors (635548, r/a=shaver). 
Back out on orange (635548, r/a=shaver). 
Improve E4X syntax error reporting.  r=nnethercote, a=shaver. 
Improve E4X syntax error reporting.  r=nnethercote, a=shaver.  (relanding in a CLOSED TREE) 
Bug 635966 - Avoid elfhack failure with llvm. r=khuey,a=shaver 
Bug 636219 - Reset interpreter's useMethodJIT flag upon entering/exiting a function (r=dvander,a=shaver) 
Bug 619565 - Fix activation object handling by InvokeSessionGuard (r=waldo,a=shaver) 
Bug 627277 - Remove (broken) BeOS support. r=biesi,dwitte,gavin,joe,jorendorff,josh,khuey,mfinkle,neil,Pike,roc,shaver,smontagu,taras 
Bug 627591: preload (xul|mozjs).dll on Windows when prefetch is off r=shaver 

This reverts commit 2cd2a529e5f1ab72569886998435bc46e22bf825. Bug 937157, part 13 - Remove DEBUG_shaver. r=bholley 
