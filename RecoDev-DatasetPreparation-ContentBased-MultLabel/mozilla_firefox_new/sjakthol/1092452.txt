17:38:43     INFO -  2795 INFO TEST-START | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js
17:38:47     INFO -  2796 INFO checking window state
17:38:47     INFO -  2797 INFO Initializing a timeline pane.
17:38:47     INFO -  2798 INFO Adding tab: http://example.com/browser/browser/devtools/timeline/test/doc_simple-test.html
17:38:47     INFO -  2799 INFO Tab added and finished loading: http://example.com/browser/browser/devtools/timeline/test/doc_simple-test.html
17:38:47     INFO -  2800 INFO TEST-PASS | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | Recording has started.
17:38:47     INFO -  2801 INFO TEST-PASS | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | Recording has ended.
17:38:47     INFO -  2802 INFO TEST-PASS | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | There are no markers available.
17:38:47     INFO -  2803 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 84.6339752193561, expected null
17:38:47     INFO -  Stack trace:
17:38:47     INFO -      chrome://mochikit/content/browser-test.js:test_is:828
17:38:47     INFO -      chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js:test<:25
17:38:47     INFO -      self-hosted:next:883
17:38:47     INFO -      Tester_execTest@chrome://mochikit/content/browser-test.js:674:9
17:38:47     INFO -      Tester.prototype.nextTest</<@chrome://mochikit/content/browser-test.js:571:7
17:38:47     INFO -      SimpleTest.waitForFocus/maybeRunTests/<@chrome://mochikit/content/tests/SimpleTest/SimpleTest.js:683:49
17:38:47     INFO -  2804 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 257.2839752193561, expected null
17:38:47     INFO -  Stack trace:
17:38:47     INFO -      chrome://mochikit/content/browser-test.js:test_is:828
17:38:47     INFO -      chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js:test<:27
17:38:47     INFO -      self-hosted:next:883
17:38:47     INFO -      Tester_execTest@chrome://mochikit/content/browser-test.js:674:9
17:38:47     INFO -      Tester.prototype.nextTest</<@chrome://mochikit/content/browser-test.js:571:7
17:38:47     INFO -      SimpleTest.waitForFocus/maybeRunTests/<@chrome://mochikit/content/tests/SimpleTest/SimpleTest.js:683:49
17:38:47     INFO -  2805 INFO TEST-OK | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | took 3847ms

17:38:43     INFO -  2795 INFO TEST-START | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js
17:38:47     INFO -  2796 INFO checking window state
17:38:47     INFO -  2797 INFO Initializing a timeline pane.
17:38:47     INFO -  2798 INFO Adding tab: http://example.com/browser/browser/devtools/timeline/test/doc_simple-test.html
17:38:47     INFO -  2799 INFO Tab added and finished loading: http://example.com/browser/browser/devtools/timeline/test/doc_simple-test.html
17:38:47     INFO -  2800 INFO TEST-PASS | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | Recording has started.
17:38:47     INFO -  2801 INFO TEST-PASS | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | Recording has ended.
17:38:47     INFO -  2802 INFO TEST-PASS | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | There are no markers available.
17:38:47     INFO -  2803 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 84.6339752193561, expected null
17:38:47     INFO -  Stack trace:
17:38:47     INFO -      chrome://mochikit/content/browser-test.js:test_is:828
17:38:47     INFO -      chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js:test<:25
17:38:47     INFO -      self-hosted:next:883
17:38:47     INFO -      Tester_execTest@chrome://mochikit/content/browser-test.js:674:9
17:38:47     INFO -      Tester.prototype.nextTest</<@chrome://mochikit/content/browser-test.js:571:7
17:38:47     INFO -      SimpleTest.waitForFocus/maybeRunTests/<@chrome://mochikit/content/tests/SimpleTest/SimpleTest.js:683:49
17:38:47     INFO -  2804 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 257.2839752193561, expected null
17:38:47     INFO -  Stack trace:
17:38:47     INFO -      chrome://mochikit/content/browser-test.js:test_is:828
17:38:47     INFO -      chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js:test<:27
17:38:47     INFO -      self-hosted:next:883
17:38:47     INFO -      Tester_execTest@chrome://mochikit/content/browser-test.js:674:9
17:38:47     INFO -      Tester.prototype.nextTest</<@chrome://mochikit/content/browser-test.js:571:7
17:38:47     INFO -      SimpleTest.waitForFocus/maybeRunTests/<@chrome://mochikit/content/tests/SimpleTest/SimpleTest.js:683:49
17:38:47     INFO -  2805 INFO TEST-OK | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | took 3847ms
submit_timestamp: 2014-10-31T18:37:10
log: https://treeherder.mozilla.org/ui/logviewer.html#?repo=fx-team&job_id=1063972
repository: fx-team
who: rvandermeulen[at]mozilla[dot]com
machine: tst-linux32-spot-278
buildname: Ubuntu VM 12.04 fx-team opt test mochitest-e10s-devtools-chrome
revision: 570921b6c566

2803 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 84.6339752193561, expected null
2804 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 257.2839752193561, expected null
submit_timestamp: 2014-11-10T01:04:35
log: https://treeherder.mozilla.org/ui/logviewer.html#?repo=mozilla-inbound&job_id=3726358
repository: mozilla-inbound
who: tomcat[at]mozilla[dot]com
machine: tst-linux32-spot-116
buildname: Ubuntu VM 12.04 mozilla-inbound opt test mochitest-e10s-devtools-chrome
revision: 961d11a08333

3064 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 34.80694205505294, expected null
3065 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 207.45694205505293, expected null
submit_timestamp: 2014-11-10T08:43:21
log: https://treeherder.mozilla.org/ui/logviewer.html#?repo=mozilla-central&job_id=610603
repository: mozilla-central
who: rvandermeulen[at]mozilla[dot]com
machine: tst-linux32-spot-1035
buildname: Ubuntu VM 12.04 mozilla-central opt test mochitest-e10s-devtools-chrome
revision: c0d559389a5c

Can't download from http://ftp.mozilla.org.proxxy1.srv.releng.use1.mozilla.com/pub/mozilla.org/firefox/tinderbox-builds/mozilla-central-linux/1415626437/firefox-36.0a1.en-US.linux-i686.tar.bz2 to /builds/slave/test/build/installer.tar.bz2!
Caught exception: timed out
Caught exception: timed out
Caught exception: timed out
3068 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 68.0858415105684, expected null
3069 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 240.7358415105684, expected null
submit_timestamp: 2014-11-10T12:15:32
log: https://treeherder.mozilla.org/ui/logviewer.html#?repo=mozilla-inbound&job_id=3738284
repository: mozilla-inbound
who: rvandermeulen[at]mozilla[dot]com
machine: tst-linux32-spot-1017
buildname: Ubuntu VM 12.04 mozilla-inbound opt test mochitest-e10s-devtools-chrome
revision: 4d3c5b18b800

3074 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 43.31289450046422, expected null
3075 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 215.96289450046422, expected null
submit_timestamp: 2014-11-10T14:59:54
log: https://treeherder.mozilla.org/ui/logviewer.html#?repo=fx-team&job_id=1151357
repository: fx-team
who: wkocher[at]mozilla[dot]com
machine: tst-linux32-spot-111
buildname: Ubuntu VM 12.04 fx-team opt test mochitest-e10s-devtools-chrome
revision: ab702308b93a

2688 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/netmonitor/test/browser_net_statistics-02.js | A promise chain failed to handle a rejection:  - at chrome://browser/content/devtools/netmonitor-view.js:2824 - TypeError: aTarget is null
2689 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/netmonitor/test/browser_net_statistics-02.js | A promise chain failed to handle a rejection:  - at chrome://browser/content/devtools/netmonitor-view.js:2824 - TypeError: aTarget is null
3095 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 56.17452425886169, expected null
3096 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 228.8245242588617, expected null
seth
https://tbpl.mozilla.org/php/getParsedLog.php?id=52405863&tree=Try
Ubuntu VM 12.04 try opt test mochitest-e10s-devtools-chrome on 2014-11-11 19:38:15
revision: fe6ad7fbfd0e
slave: tst-linux32-spot-694

3106 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 10.850598430727562, expected null
3107 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 183.50059843072756, expected null
submit_timestamp: 2014-11-12T17:22:59
log: https://treeherder.mozilla.org/ui/logviewer.html#?repo=mozilla-central&job_id=624032
repository: mozilla-central
who: wkocher[at]mozilla[dot]com
machine: tst-linux32-spot-551
buildname: Ubuntu VM 12.04 mozilla-central pgo test mochitest-e10s-devtools-chrome
revision: 66cdb18f36da

3097 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 21.492106685885027, expected null
3098 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 194.14210668588504, expected null
submit_timestamp: 2014-11-12T19:18:35
log: https://treeherder.mozilla.org/ui/logviewer.html#?repo=mozilla-inbound&job_id=3839689
repository: mozilla-inbound
who: rvandermeulen[at]mozilla[dot]com
machine: tst-linux32-spot-1002
buildname: Ubuntu VM 12.04 mozilla-inbound pgo test mochitest-e10s-devtools-chrome
revision: 581fc5d481de

3142 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 85.15546266491026, expected null
3143 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 257.80546266491024, expected null
submit_timestamp: 2014-11-13T02:55:54
log: https://treeherder.mozilla.org/ui/logviewer.html#?repo=mozilla-inbound&job_id=3848104
repository: mozilla-inbound
who: tomcat[at]mozilla[dot]com
machine: tst-linux32-spot-354
buildname: Ubuntu VM 12.04 mozilla-inbound pgo test mochitest-e10s-devtools-chrome
revision: 4f9e282d1adb

3133 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 60.08914077833333, expected null
3134 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 232.73914077833334, expected null
submit_timestamp: 2014-11-13T08:41:26
log: https://treeherder.mozilla.org/ui/logviewer.html#?repo=mozilla-inbound&job_id=3860871
repository: mozilla-inbound
who: rvandermeulen[at]mozilla[dot]com
machine: tst-linux32-spot-169
buildname: Ubuntu VM 12.04 mozilla-inbound opt test mochitest-e10s-devtools-chrome
revision: 7db30249d1d8

3142 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 136.94832582260963, expected null
3143 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 309.59832582260964, expected null
submit_timestamp: 2014-11-13T09:17:33
log: https://treeherder.mozilla.org/ui/logviewer.html#?repo=mozilla-central&job_id=627910
repository: mozilla-central
who: rvandermeulen[at]mozilla[dot]com
machine: tst-linux32-spot-278
buildname: Ubuntu VM 12.04 mozilla-central opt test mochitest-e10s-devtools-chrome
revision: ae27ae77e32f

3142 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 34.78758511631701, expected null
3143 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 207.43758511631702, expected null
submit_timestamp: 2014-11-13T18:35:57
log: https://treeherder.mozilla.org/ui/logviewer.html#?repo=mozilla-central&job_id=631339
repository: mozilla-central
who: rvandermeulen[at]mozilla[dot]com
machine: tst-linux32-spot-028
buildname: Ubuntu VM 12.04 mozilla-central opt test mochitest-e10s-devtools-chrome
revision: 44cdce6fca3a

3142 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. - Got 32.29319602747267, expected null
3143 INFO TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/timeline/test/browser_timeline_overview-initial-selection-02.js | The initial selection end is correct. - Got 204.94319602747268, expected null
Created attachment 8522977
timeline-initial-selection-02-intermittent.patch

It appears that I was wrong with the fix of bug 1067287: the test requires that the marker arrays are empty both before and after calling _stopRecording. It probably only appears in e10s as there's IPC overhead giving 

This bug is probably caused by following chain of events:
1. Recording starts
2. Server pushes some markers to the client.
3. Test continues executing and executes following call chain:
> _stopRecordingAndDiscardData
> _stopRecording
> handleRecordingEnded
4. In handleRecordingEnded, on lines 344-352, the true branch is taken. This causes the selection start and end to be something other than the test expects.

Here's a try run: https://treeherder.mozilla.org/ui/#/jobs?repo=try&revision=347625158801
https://hg.mozilla.org/integration/fx-team/rev/b6e4173bdd9d
https://hg.mozilla.org/mozilla-central/rev/b6e4173bdd9d
https://hg.mozilla.org/releases/mozilla-aurora/rev/bd787c46f113
Sorry for the spam. Moving bugs to Firefox :: Developer Tools: Performance Tools (Profiler/Timeline).

dkl


Intermittent browser_timeline_overview-initial-selection-02.js | The initial selection start is correct. | The initial selection end is correct.

intermittent-failure

Bug 1092452 - Fix intermittent mochitest-e10s-dt failure in browser_timeline_overview-initial-selection-02.js. r=vporof 