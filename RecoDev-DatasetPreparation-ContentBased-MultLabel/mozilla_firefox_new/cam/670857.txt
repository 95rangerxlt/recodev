Once bug 652494 is fixed, the deliberate uncaught JS exceptions from various hudservice tests will cause test failures.  We'll need to be able to indicate that these uncaught exceptions are expected, if they cannot be removed without affecting the point of the tests.  Bug 670817 might introduce a SimpleTest.expectUncaughtException() which we could use for this.

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_580030_errors_after_page_reload.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBazBaz is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-error.html:15
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_582201_duplicate_errors.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooDuplicateError1 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-duplicate-error.html:16
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_582201_duplicate_errors.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooDuplicateError1 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-duplicate-error.html:16
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_597136_external_script_errors.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: bogus is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-597136-external-script-errors.js:12
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_597756_reopen_closed_tab.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBug597756_error is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-597756-reopen-closed-tab.html:14
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_597756_reopen_closed_tab.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBug597756_error is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-597756-reopen-closed-tab.html:14
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_597756_reopen_closed_tab.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBug597756_error is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-597756-reopen-closed-tab.html:14
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_597756_reopen_closed_tab.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBug597756_error is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-597756-reopen-closed-tab.html:14
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_601177_log_levels.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: window.foobarBug601177exception is not a function at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-601177-log-levels.js:8
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_618078_network_exceptions.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: bug618078exception is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-618078-network-exceptions.html:13
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: bar is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:14
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar0 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar1 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar2 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar3 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar4 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar5 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar6 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar7 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar8 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar9 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar10 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_network_panel.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: uncaught exception: [object StopIteration] at :0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_view_source.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBazBaz is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-error.html:15

Once bug 652494 is fixed, the deliberate uncaught JS exceptions from various hudservice tests will cause test failures.  We'll need to be able to indicate that these uncaught exceptions are expected, if they cannot be removed without affecting the point of the tests.  Bug 670817 might introduce a SimpleTest.expectUncaughtException() which we could use for this.

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_580030_errors_after_page_reload.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBazBaz is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-error.html:15
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_582201_duplicate_errors.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooDuplicateError1 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-duplicate-error.html:16
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_582201_duplicate_errors.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooDuplicateError1 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-duplicate-error.html:16
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_597136_external_script_errors.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: bogus is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-597136-external-script-errors.js:12
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_597756_reopen_closed_tab.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBug597756_error is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-597756-reopen-closed-tab.html:14
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_597756_reopen_closed_tab.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBug597756_error is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-597756-reopen-closed-tab.html:14
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_597756_reopen_closed_tab.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBug597756_error is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-597756-reopen-closed-tab.html:14
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_597756_reopen_closed_tab.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBug597756_error is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-597756-reopen-closed-tab.html:14
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_601177_log_levels.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: window.foobarBug601177exception is not a function at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-601177-log-levels.js:8
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_618078_network_exceptions.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: bug618078exception is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-618078-network-exceptions.html:13
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: bar is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:14
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar0 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar1 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar2 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar3 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar4 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar5 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar6 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar7 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar8 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar9 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_bug_644419_log_limits.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fubar10 is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-bug-644419-log-limits.html:0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_network_panel.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: uncaught exception: [object StopIteration] at :0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/components/console/hudservice/tests/browser/browser_webconsole_view_source.js | [SimpleTest/SimpleTest.js, window.onerror] - An error occurred: fooBazBaz is not defined at http://example.com/browser/toolkit/components/console/hudservice/tests/browser/test-error.html:15
Thank you for your report.

Indeed, we will have to use the new mechanism for indicating that the uncaught exceptions are expected.

Bug 652494 is a welcome improvement to mochitests. Is there a timeline for landing 652494? For when we'll have to complete our mochitest updates.
mihai, do you want to take this?
Sure, I can take it.
I guess bug 652494 will land as soon as the dependent bugs are fixed. ;)  I'm not actively working on the dependent bugs, but I may pick them up as time permits.  The actual patch for bug 652494 will be quite small.
Mihai, are you working on this at the moment?  If not, I'm happy to take it.
(In reply to Cameron McCormack (:heycam) from comment #5)
> Mihai, are you working on this at the moment?  If not, I'm happy to take it.

I am not working on this, at the moment. I would very much appreciate your help with taking this!

Thank you!
No problem!
Created attachment 575128
Make web console tests expect particular uncaught exceptions.

Add expectUncaughtException() in appropriate places.
browser_webconsole_network_panel.js needed an actual fix for an unintended
uncaught exception.
Comment on attachment 575128
Make web console tests expect particular uncaught exceptions.

Review of attachment 575128:
-----------------------------------------------------------------

Patch looks good. Thank you very much Cameron!
https://hg.mozilla.org/integration/mozilla-inbound/rev/be842b38277f
Backed out: https://hg.mozilla.org/integration/mozilla-inbound/rev/1b8f7b176406
Will need to land this at the same time as bug 703176.
https://hg.mozilla.org/mozilla-central/rev/de720961a78d
Backed out: https://hg.mozilla.org/mozilla-central/rev/c101c5f8c928
Trying again: https://hg.mozilla.org/integration/mozilla-inbound/rev/90cb5809e7f0
https://hg.mozilla.org/mozilla-central/rev/90cb5809e7f0


Various hudservice tests have deliberate uncaught JS exceptions that will cause a test failure in the future



Bug 670857 - Make web console tests expect particular uncaught exceptions. r=msucan 

Bug 670857 - Make web console tests expect particular uncaught exceptions. r=msucan 

Backout bug 670857, bug 703176 

Bug 670857 - Make web console tests expect particular uncaught exceptions. r=msucan 