https://tbpl.mozilla.org/php/getParsedLog.php?id=28162248&tree=Mozilla-Inbound
slave: t-w864-ix-081



10:45:39     INFO -  TEST-START | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js
10:45:39  WARNING -  TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
10:45:39     INFO -  Stack trace:
10:45:39     INFO -      JS frame :: chrome://mochikit/content/browser-test.js :: test_isnot :: line 629
10:45:39     INFO -      JS frame :: chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js :: performTest :: line 33
10:45:39     INFO -      JS frame :: resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/webconsole/webconsole.js :: <TOP_LEVEL> :: line 3111
10:45:39     INFO -      JS frame :: resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/webconsole/webconsole.js :: WCF__flushMessageQueue :: line 2035
10:45:39     INFO -      native frame :: <unknown filename> :: <TOP_LEVEL> :: line 0


Followed by 
10:45:39     INFO -  TEST-INFO | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | output height 164 node top 56 node bottom 78 node height 22
10:45:39     INFO -  TEST-PASS | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | last message is visible
10:45:39     INFO -  console.error:
10:45:39     INFO -    Message: TypeError: null has no properties
10:45:39     INFO -    Stack:
10:45:39     INFO -      @resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/webconsole/webconsole.js:3117
10:45:39     INFO -  WCF__flushMessageQueue@resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/webconsole/webconsole.js:2035
10:45:39     INFO -  INFO TEST-END | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | finished in 534ms

https://tbpl.mozilla.org/php/getParsedLog.php?id=28162248&tree=Mozilla-Inbound
slave: t-w864-ix-081



10:45:39     INFO -  TEST-START | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js
10:45:39  WARNING -  TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
10:45:39     INFO -  Stack trace:
10:45:39     INFO -      JS frame :: chrome://mochikit/content/browser-test.js :: test_isnot :: line 629
10:45:39     INFO -      JS frame :: chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js :: performTest :: line 33
10:45:39     INFO -      JS frame :: resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/webconsole/webconsole.js :: <TOP_LEVEL> :: line 3111
10:45:39     INFO -      JS frame :: resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/webconsole/webconsole.js :: WCF__flushMessageQueue :: line 2035
10:45:39     INFO -      native frame :: <unknown filename> :: <TOP_LEVEL> :: line 0


Followed by 
10:45:39     INFO -  TEST-INFO | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | output height 164 node top 56 node bottom 78 node height 22
10:45:39     INFO -  TEST-PASS | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | last message is visible
10:45:39     INFO -  console.error:
10:45:39     INFO -    Message: TypeError: null has no properties
10:45:39     INFO -    Stack:
10:45:39     INFO -      @resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/webconsole/webconsole.js:3117
10:45:39     INFO -  WCF__flushMessageQueue@resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/webconsole/webconsole.js:2035
10:45:39     INFO -  INFO TEST-END | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | finished in 534ms
philor
https://tbpl.mozilla.org/php/getParsedLog.php?id=28258607&tree=B2g-Inbound
WINNT 6.2 b2g-inbound pgo test mochitest-browser-chrome on 2013-09-23 18:39:14
revision: 8b28b4bed72c
slave: t-w864-ix-018

TypeError: this._windows[aWindow.__SSi] is undefined
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
Gijs
https://tbpl.mozilla.org/php/getParsedLog.php?id=28400022&tree=Fx-Team
WINNT 6.2 fx-team opt test mochitest-browser-chrome on 2013-09-26 03:37:56
revision: 55bd39f913d1
slave: t-w864-ix-098

TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
ReferenceError: info is not defined
ReferenceError: info is not defined
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
philor
https://tbpl.mozilla.org/php/getParsedLog.php?id=28404057&tree=Mozilla-Inbound
Rev5 MacOSX Mountain Lion 10.8 mozilla-inbound opt test mochitest-browser-chrome on 2013-09-26 05:51:29
revision: f3af1a0b239d
slave: talos-mtnlion-r5-051

TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
ReferenceError: info is not defined
ReferenceError: info is not defined
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
philor
https://tbpl.mozilla.org/php/getParsedLog.php?id=28528453&tree=Mozilla-Inbound
WINNT 6.2 mozilla-inbound pgo test mochitest-browser-chrome on 2013-09-28 21:07:53
revision: c0e0775a2364
slave: t-w864-ix-110

TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
ReferenceError: info is not defined
ReferenceError: info is not defined
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
Gijs
https://tbpl.mozilla.org/php/getParsedLog.php?id=28669628&tree=Try
Windows 7 32-bit try opt test mochitest-browser-chrome on 2013-10-02 05:37:57
revision: e642f5419418
slave: t-w732-ix-033

TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
ReferenceError: info is not defined
ReferenceError: info is not defined
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
Gijs
https://tbpl.mozilla.org/php/getParsedLog.php?id=28761774&tree=Mozilla-Central
WINNT 6.2 mozilla-central opt test mochitest-browser-chrome on 2013-10-04 23:24:18
revision: 758fdfc588f6
slave: t-w864-ix-018

TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
ReferenceError: info is not defined
ReferenceError: info is not defined
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
Tomcat
https://tbpl.mozilla.org/php/getParsedLog.php?id=29126423&tree=Mozilla-Inbound
Rev4 MacOSX Lion 10.7 mozilla-inbound opt test mochitest-browser-chrome on 2013-10-15 02:01:48
revision: 5db1f111ac19
slave: talos-r4-lion-082

TypeError: this.markup is undefined: InspectorPanel_onNewRoot/</<@resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/inspector/inspector-panel.js:321
TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Tomcat
https://tbpl.mozilla.org/php/getParsedLog.php?id=29181373&tree=Mozilla-Inbound
WINNT 6.2 mozilla-inbound opt test mochitest-browser-chrome on 2013-10-16 03:21:46
revision: 6cb17f49e135
slave: t-w864-ix-114

TypeError: this.markup is undefined: InspectorPanel_onNewRoot/</<@resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/inspector/inspector-panel.js:321
TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
TypeError: this._measurement.parentNode is null
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
mbrubeck
https://tbpl.mozilla.org/php/getParsedLog.php?id=29275522&tree=Mozilla-Inbound
WINNT 6.2 mozilla-inbound opt test mochitest-browser-chrome on 2013-10-17 14:58:08
revision: dbc405bc63b5
slave: t-w864-ix-086

TypeError: this.markup is undefined: InspectorPanel_onNewRoot/</<@resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/inspector/inspector-panel.js:321
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
philor
https://tbpl.mozilla.org/php/getParsedLog.php?id=29289301&tree=Mozilla-Inbound
WINNT 6.2 mozilla-inbound opt test mochitest-browser-chrome on 2013-10-17 19:47:38
revision: 7349a4fc4d58
slave: t-w864-ix-083

TypeError: this.markup is undefined: InspectorPanel_onNewRoot/</<@resource://gre/modules/commonjs/toolkit/loader.js -> resource:///modules/devtools/inspector/inspector-panel.js:321
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
philor
https://tbpl.mozilla.org/php/getParsedLog.php?id=29563951&tree=Mozilla-Inbound
WINNT 6.2 mozilla-inbound opt test mochitest-browser-chrome on 2013-10-23 12:39:07
revision: 376956b7585a
slave: t-w864-ix-095

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
philor
https://tbpl.mozilla.org/php/getParsedLog.php?id=29571720&tree=Mozilla-Inbound
Rev4 MacOSX Snow Leopard 10.6 mozilla-inbound opt test mochitest-browser-chrome on 2013-10-23 15:10:57
revision: b7c32ea628e2
slave: talos-r4-snow-005

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/mozapps/extensions/test/xpinstall/browser_httphash3.js | Test timed out
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/mozapps/extensions/test/xpinstall/browser_httphash3.js | Should be no active installs at the end of the test - Got 1, expected 0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/mozapps/extensions/test/xpinstall/browser_httphash3.js | Found a tab after previous test timed out: http://example.com/browser/toolkit/mozapps/extensions/test/xpinstall/installtrigger.html?%7B%22Unsigned%20XPI%22%3A%7B%22URL%22%3A%22https%3A%2F%2Fexample.com%2Fbrowser%2Ftoolkit%2Fmozapps%2Fextensions%2Ftest%2Fxpinstall%2FhashRedirect.sjs%3Fsha1%3Afoobar%7Chttp%3A%2F%2Fexample.com%2Fbrowser%2Ftoolkit%2Fmozapps%2Fextensions%2Ftest%2Fxpinstall%2Funsigned.xpi%22%2C%22Hash%22%3A%22sha1%3A3d0dc22e1f394e159b08aaf5f0f97de4d5c65f4f%22%7D%7D
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/mozapps/extensions/test/xpinstall/browser_httphash5.js | Test timed out
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/mozapps/extensions/test/xpinstall/browser_httphash5.js | Should be no active installs at the end of the test - Got 1, expected 0
TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/toolkit/mozapps/extensions/test/xpinstall/browser_httphash5.js | Found a tab after previous test timed out: http://example.com/browser/toolkit/mozapps/extensions/test/xpinstall/installtrigger.html?%7B%22Unsigned%20XPI%22%3A%7B%22URL%22%3A%22https%3A%2F%2Fexample.com%2Fbrowser%2Ftoolkit%2Fmozapps%2Fextensions%2Ftest%2Fxpinstall%2FhashRedirect.sjs%3Fsha1%3A3d0dc22e1f394e159b08aaf5f0f97de4d5c65f4f%7Chttps%3A%2F%2Fexample.com%2Fbrowser%2Ftoolkit%2Fmozapps%2Fextensions%2Ftest%2Fxpinstall%2FhashRedirect.sjs%3Fsha1%3Afoobar%7Chttp%3A%2F%2Fexample.com%2Fbrowser%2Ftoolkit%2Fmozapps%2Fextensions%2Ftest%2Fxpinstall%2Funsigned.xpi%22%7D%7D
KWierso
https://tbpl.mozilla.org/php/getParsedLog.php?id=30718458&tree=Fx-Team
WINNT 6.2 fx-team pgo test mochitest-browser-chrome on 2013-11-18 12:33:04
revision: 838fe39e3dc5
slave: t-w864-ix-058

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
philor
https://tbpl.mozilla.org/php/getParsedLog.php?id=31347707&tree=Holly
WINNT 6.2 holly pgo test mochitest-browser-chrome on 2013-12-02 16:45:40
revision: 49fde22e631e
slave: t-w864-ix-062

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
philor
https://tbpl.mozilla.org/php/getParsedLog.php?id=32418381&tree=Mozilla-Inbound
WINNT 6.2 mozilla-inbound pgo test mochitest-browser-chrome on 2013-12-29 02:03:46
revision: a180d08b23fe
slave: t-w864-ix-041

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
KWierso
https://tbpl.mozilla.org/php/getParsedLog.php?id=32606352&tree=Mozilla-Inbound
Windows XP 32-bit mozilla-inbound pgo test mochitest-browser-chrome on 2014-01-06 16:30:27
revision: 4a613dc5e5c7
slave: t-xp32-ix-032

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
Tomcat
https://tbpl.mozilla.org/php/getParsedLog.php?id=32685546&tree=Mozilla-Inbound
WINNT 6.2 mozilla-inbound pgo test mochitest-browser-chrome on 2014-01-07 23:47:48
revision: 15f55912548a
slave: t-w864-ix-036

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
Created attachment 8361005
bug919072-1.diff

Attempt to fix this intermittent failure. Sometimes the scrollTop value is not updated soon enough for the test. This patch tries to force a reflow before checking scrollTop.

r=me

Landed: https://hg.mozilla.org/integration/fx-team/rev/647072336c9e
https://hg.mozilla.org/mozilla-central/rev/647072336c9e
https://hg.mozilla.org/releases/mozilla-aurora/rev/9c59eb7fb40c
https://hg.mozilla.org/releases/mozilla-beta/rev/8e90d365bd12
https://hg.mozilla.org/releases/mozilla-b2g26_v1_2/rev/d48bfe9f5af7
KWierso
https://tbpl.mozilla.org/php/getParsedLog.php?id=33432045&tree=B2g-Inbound
WINNT 6.2 b2g-inbound pgo test mochitest-browser-chrome on 2014-01-22 18:29:12
revision: ee87d9380ff1
slave: t-w864-ix-066

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
philor
https://tbpl.mozilla.org/php/getParsedLog.php?id=33462925&tree=Holly
Windows XP 32-bit holly pgo test mochitest-browser-chrome on 2014-01-23 07:25:16
revision: bf66280f5f37
slave: t-xp32-ix-119

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
philor
https://tbpl.mozilla.org/php/getParsedLog.php?id=33672397&tree=Fx-Team
Windows XP 32-bit fx-team pgo test mochitest-browser-chrome on 2014-01-27 21:30:52
revision: 598d1bac661d
slave: t-xp32-ix-054

TEST-UNEXPECTED-FAIL | chrome://mochitests/content/browser/browser/devtools/webconsole/test/browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it
Return code: 1
Created attachment 8374387
bug919072-2.diff

Did more investigation for this test failure. Identified two problems:

- the test doesnt wait for all messages to be displayed in the output. the test assumes that the eval output will be after the console.log() calls, which is not always true.

- how the test checks if the last message is visible is not accurate.


Updated the test to fix both issues, and rewrote it using Task.spawn().

Green try run: https://tbpl.mozilla.org/?tree=Try&rev=004275fdaf61


r=me

Landed: https://hg.mozilla.org/integration/fx-team/rev/d2f51fa6a16d
https://hg.mozilla.org/mozilla-central/rev/d2f51fa6a16d


Intermittent  TEST-UNEXPECTED-FAIL | browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it

intermittent-failure

Bug 919072 - Fix for intermittent TEST-UNEXPECTED-FAIL | browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it; r=me 

Bug 919072 - Fix for intermittent TEST-UNEXPECTED-FAIL | browser_webconsole_bug_601352_scroll.js | scroll location is not at the top - Didn't expect 0, but got it; r=me 